___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "FigPii",
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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\u003d"
  },
  "description": "Integrate FigPii ALL-IN-ONE CRO platform with any website in 2 clicks.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "accessKey",
    "displayName": "Access Key",
    "simpleValueType": true,
    "help": "You can find your Access Key by going to https://figpii.com/dashboard"
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

// require relevant API
const injectScript = require('injectScript');
const logToConsole = require('logToConsole');
const queryPermission = require('queryPermission');
const encodeUriComponent = require('injectScript');

// capture values of template fields
var src = data.accessKey;

// define tracking code
var url = 'https://tracking-cdn.figpii.com/' + src + '.js';
url = encodeUriComponent(url);

// If the user chose to log debug output, initialize the logging method
const log = data.debug ? logToConsole : (() => {});

log('Loading script from ' + url);

// If the script loaded successfully, log a message and signal success
const onSuccess = () => {
  log('Script loaded successfully.');
  data.gtmOnSuccess();
};

// If the script fails to load, log a message and signal failure
const onFailure = () => {
  log('Script load failed.');
  data.gtmOnFailure();
};

// If the URL input by the user matches the permissions set for the template,
// inject the script with the onSuccess and onFailure methods as callbacks.
if (queryPermission('inject_script', url)) {
  injectScript(url, onSuccess, onFailure);
} else {
  log('Script load failed due to permissions mismatch.');
  data.gtmOnFailure();
}


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://tracking-cdn.figpii.com/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 9/13/2021, 1:42:32 PM


